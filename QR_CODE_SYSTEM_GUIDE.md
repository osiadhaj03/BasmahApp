# نظام QR Code للحضور - BasmahApp

## 🎯 نظرة عامة

تم إضافة نظام QR Code متطور لتسجيل الحضور في BasmahApp يتيح:
- للمعلمين: عرض QR Code على شاشة القاعة
- للطلاب: مسح QR Code لتسجيل الحضور تلقائياً
- نافذة حضور محددة (أول 15 دقيقة من بداية الدرس)
- تحقق أمني من الصلاحيات والأوقات

## 📊 إحصائيات النظام

- **375+ درس** موزع على 5 أيام أسبوعية
- **50 طالب** و **8+ معلمين**
- **15 مادة دراسية** مختلفة
- **6 فترات زمنية** يومية
- **نظام QR Code** آمن ومشفر

## 🔄 سيناريو الاستخدام

### 1. المعلم يبدأ الدرس
```
المعلم يسجل دخول → قائمة الدروس → زر QR Code → عرض على الشاشة
```

### 2. الطالب يسجل الحضور
```
الطالب يسجل دخول → لوحة التحكم → ماسح QR Code → مسح الكود → تسجيل تلقائي
```

### 3. التحقق الأمني
```
النظام يتحقق من:
- صحة QR Code وتوقيته
- تسجيل الطالب في الدرس
- نافذة الحضور (15 دقيقة)
- عدم التسجيل المسبق
```

## 🛠️ الملفات المضافة

### Controllers
- `app/Http/Controllers/QRCodeController.php` - كنترولر QR Code

### Views
- `resources/views/admin/lessons/qr-display.blade.php` - عرض QR للمعلم
- `resources/views/admin/lessons/qr-fullscreen.blade.php` - عرض ملء الشاشة
- `resources/views/student/qr-scanner.blade.php` - ماسح QR للطالب

### Models
- تحديث `app/Models/Lesson.php` - إضافة وظائف QR Code

### Migrations
- `database/migrations/2024_06_18_000001_add_qr_code_to_lessons_table.php`

### Routes
- تحديث `routes/web.php` - إضافة مسارات QR Code

## 🎮 كيفية الاستخدام

### للمعلمين:

1. **تسجيل الدخول**
   ```
   البريد: teacher1@basmahapp.com
   الرقم السري: password
   ```

2. **عرض QR Code**
   - انتقل إلى "الدروس"
   - اضغط زر QR Code (الأيقونة الخضراء)
   - اضغط "عرض في الشاشة الكاملة"
   - عرض على شاشة القاعة

3. **مراقبة الحضور**
   - عرض إحصائيات مباشرة
   - تجديد QR Code عند الحاجة
   - مراقبة نافذة الحضور

### للطلاب:

1. **تسجيل الدخول**
   ```
   البريد: student1@basmahapp.com
   الرقم السري: password
   ```

2. **مسح QR Code**
   - انتقل إلى لوحة التحكم
   - اضغط "فتح ماسح QR Code"
   - اسمح بالوصول للكاميرا
   - وجه الكاميرا نحو QR Code

3. **تأكيد الحضور**
   - النظام يعرض رسالة تأكيد
   - عرض تفاصيل الدرس والوقت
   - العودة للوحة التحكم

## 🔐 الأمان والتحقق

### QR Code مشفر يحتوي على:
- معرف الدرس
- التاريخ والوقت
- رمز تشفير فريد

### التحقق من:
- ✅ صحة وصلاحية QR Code
- ✅ تسجيل الطالب في الدرس
- ✅ نافذة الحضور (15 دقيقة)
- ✅ عدم التسجيل المسبق
- ✅ مطابقة اليوم والوقت

## ⏰ نافذة الحضور

- **مدة النافذة**: 15 دقيقة من بداية الدرس
- **حالة التسجيل**: تلقائي كـ "حاضر"
- **التحديث**: QR Code يتجدد كل 5 دقائق
- **انتهاء الصلاحية**: QR Code صالح لـ 6 ساعات

## 📱 المتطلبات التقنية

### للطلاب:
- متصفح حديث مع دعم الكاميرا
- السماح بالوصول للكاميرا
- اتصال إنترنت مستقر

### للمعلمين:
- جهاز عرض أو شاشة ذكية
- متصفح حديث
- اتصال إنترنت

## 🚀 التشغيل والإعداد

### تشغيل سريع:
```powershell
.\setup_qr_system.ps1
```

### تشغيل يدوي:
```bash
# تثبيت الحزم
composer require simplesoftwareio/simple-qrcode

# تحديث قاعدة البيانات
php artisan migrate

# إنشاء البيانات
php create_large_lessons_dataset.php
```

## 🔧 استكشاف الأخطاء

### مشاكل شائعة:

1. **الكاميرا لا تعمل**
   - تأكد من السماح بالوصول للكاميرا
   - جرب متصفح مختلف
   - استخدم الإدخال اليدوي

2. **QR Code غير صالح**
   - تأكد من أن الوقت ضمن نافذة الحضور
   - تحقق من تسجيلك في الدرس
   - جرب تجديد QR Code

3. **خطأ في التسجيل**
   - تأكد من اتصال الإنترنت
   - تحقق من بيانات تسجيل الدخول
   - تأكد من عدم التسجيل المسبق

## 📞 الدعم التقني

للحصول على مساعدة:
1. راجع هذا الدليل أولاً
2. تحقق من سجلات النظام
3. اتصل بفريق الدعم التقني

---

**BasmahApp** - نظام إدارة الحضور الذكي 🎓
